{
  "MqttBroker": {
    "Port": 8883,
    "UseSsl": true,
    "CertificatePath": "certificate.pfx",
    "CertificatePassword": "",
    "MaxPendingMessagesPerClient": 100,
    "ConnectionBacklog": 10
  },
  
  "RateLimiting": {
    "Enabled": true,
    "DuplicatePacketWindow": 300,
    "PerNodePacketLimit": {
      "MaxPacketsPerMinute": 60,
      "BanDurationMinutes": 30
    },
    "GlobalPacketLimit": {
      "MaxPacketsPerMinute": 1000
    }
  },
  
  "PacketFiltering": {
    "BlockUnknownTopics": true,
    "AllowedTopics": [
      "msh/+/2/e/+/+",
      "msh/+/2/json/+/+"
    ],
    "BlockUndecryptablePackets": true,
    "AllowedChannels": [
      "LongFast",
      "ShortFast"
    ],
    "BlockedPortNums": [],
    "AllowedPortNums": [
      1,
      3,
      4,
      67
    ],
    "MaxHopCount": 3,
    "ZeroHopPortNums": [
      67
    ]
  },
  
  "ConnectionModeration": {
    "Fail2Ban": {
      "Enabled": true,
      "MaxFailedAuthAttempts": 5,
      "BanDurationMinutes": 60,
      "FindTimeMinutes": 10
    },
    "RequireAuthentication": false,
    "AllowedClients": [],
    "BlockedClients": [],
    "KnownBadActors": []
  },
  
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "MQTTnet": "Information"
    },
    "WriteTo": [
      {
        "Name": "Console"
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/mqtt-broker-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 7
        }
      }
    ]
  },
  
  "Metrics": {
    "Enabled": true,
    "TrackPerNodeStats": true,
    "ExportInterval": 60
  }
}
